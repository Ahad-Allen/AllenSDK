<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Mouse Connectivity &mdash; Allen SDK 0.14.2 documentation</title>
    
    <link rel="stylesheet" href="_static/aibs_sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.14.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Allen SDK 0.14.2 documentation" href="index.html" />
    <link rel="up" title="Data Resources" href="data_resources.html" />
    <link rel="next" title="Reference Space" href="reference_space.html" />
    <link rel="prev" title="Cell Types" href="cell_types.html" /> 
  </head>
  <body role="document">
<link href="http://www.brain-map.org/assets/stylesheets/portal.css" media="screen" rel="stylesheet" type="text/css" />
<script src="http://www.brain-map.org/assets/javascripts/portal.js" type="text/javascript"></script>
<script src="http://www.brain-map.org/assets/javascripts/ga.js" type="text/javascript"></script>
<script type="text/javascript">
    var _pSupressBrowserFlashWarning = true;
    var _pTabId = "pHome";
    var _pMoreProjectsId = "pMoreProjects";
    var _pImagePath = "http://www.brain-map.org/assets/images/";
    var _pSiteWarnings = function() {
        this.show_warning() = {};
    }
</script>
<script type="text/javascript">
    function initialize() {
        /*** do your stuff, then initialize the portal plugin ***/
        _pPortalOnLoad();
    }
</script>
<style>
  #header_content > a {
  display: inline-block;
  width: 250px;
  height: 75px;
  background-image:url("/AllenSDK/_static/external_assets/images/Brain_Atlas_Logotype_SDK.png") !important;
  background-size: 235px 37px;
  background-position: 0px 20px;
  background-repeat: no-repeat;
  }
</style>

<script type="text/javascript" src="http://www.brain-map.org/external_assets/javascripts/portalHeader.js"></script>
<link rel="stylesheet" type="text/css" href="/AllenSDK/_static/external_assets/stylesheets/common_layout.css" />


  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mouse-connectivity">
<h1>Mouse Connectivity<a class="headerlink" href="#mouse-connectivity" title="Permalink to this headline">¶</a></h1>
<p>The Allen Mouse Brain Connectivity Atlas consists of high-resolution images of axonal projections targeting different anatomic regions or various cell types using Cre-dependent specimens. Each data set is processed through an informatics data analysis pipeline to obtain spatially mapped quantified projection information.</p>
<p>This page describes how to use the SDK to access experimental projection data and metadata.  For more information,
please visit the Connectivity Atlas <a class="reference external" href="http://connectivity.brain-map.org/">home page</a> and the
<a class="reference external" href="http://help.brain-map.org/display/mouseconnectivity/ALLEN+Mouse+Brain+Connectivity+Atlas">API documentation</a></p>
<div class="section" id="structure-level-projection-data">
<h2>Structure-Level Projection Data<a class="headerlink" href="#structure-level-projection-data" title="Permalink to this headline">¶</a></h2>
<p>All AAV projection signal in the Allen Mouse Connectivity Atlas has been registered to the expert-annotated Common Coordinate Framework (CCF)
and summarized to structures in the adult mouse structure ontology.  Most commonly used for analysis are measures of the density of projection
signal in all brain areas for every experiment.  This data is available for download and is described
in more detail on the <a class="reference internal" href="unionizes.html"><span class="doc">structure unionizes page</span></a>.</p>
</div>
<div class="section" id="voxel-level-projection-data">
<h2>Voxel-Level Projection Data<a class="headerlink" href="#voxel-level-projection-data" title="Permalink to this headline">¶</a></h2>
<p>The CCF-registered AAV projection signal is also available for download as a set of 3D volumes for each experiment.  The following data volumes
are available for download:</p>
<blockquote>
<div><ul class="simple">
<li><strong>projection density</strong>: sum of detected projection pixels / sum of all pixels in voxel</li>
<li><strong>injection_fraction</strong>: fraction of pixels belonging to manually annotated injection site</li>
<li><strong>injection_density</strong>: density of detected projection pixels within the manually annotated injection site</li>
<li><strong>data_mask</strong>: binary mask indicating if a voxel contains valid data. Only valid voxels should be used for analysis.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="code-examples">
<h2>Code Examples<a class="headerlink" href="#code-examples" title="Permalink to this headline">¶</a></h2>
<p>The Mouse Connectivity <a class="reference external" href="_static/examples/nb/mouse_connectivity.html">Jupyter notebook</a> has many code samples to help get
started with analysis:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="_static/examples/nb/mouse_connectivity.html#Mouse-Connectivity">Download experimental metadata by injection structure and transgenic line</a></li>
<li><a class="reference external" href="_static/examples/nb/mouse_connectivity.html#Structure-Signal-Unionization">Download projection signal statistics at a structure level</a></li>
<li><a class="reference external" href="_static/examples/nb/mouse_connectivity.html#Generating-a-Projection-Matrix">Build a structure-to-structure matrix of projection signal values</a></li>
<li><a class="reference external" href="_static/examples/nb/mouse_connectivity.html#Manipulating-Grid-Data">Download and visualize gridded projection signal volumes</a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="mouse-connectivity-api">
<h2>Mouse Connectivity API<a class="headerlink" href="#mouse-connectivity-api" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="allensdk.api.queries.html#allensdk.api.queries.mouse_connectivity_api.MouseConnectivityApi" title="allensdk.api.queries.mouse_connectivity_api.MouseConnectivityApi"><code class="xref py py-class docutils literal"><span class="pre">MouseConnectivityApi</span></code></a> class provides a Python interface
for downloading data in the Allen Mouse Brain Connectivity Atlas.  The following example demonstrates how to download
meta data for all wild-type injections and the projection signal density for one experiment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">allensdk.api.queries.mouse_connectivity_api</span> <span class="k">import</span> <span class="n">MouseConnectivityApi</span>
<span class="kn">import</span> <span class="nn">nrrd</span>

<span class="n">mca</span> <span class="o">=</span> <span class="n">MouseConnectivityApi</span><span class="p">()</span>

<span class="c1"># get metadata for all non-Cre experiments</span>
<span class="n">experiments</span> <span class="o">=</span> <span class="n">mca</span><span class="o">.</span><span class="n">experiment_source_search</span><span class="p">(</span><span class="n">injection_structures</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="n">transgenic_lines</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># download the projection density volume for one of the experiments</span>
<span class="n">mca</span><span class="o">.</span><span class="n">download_projection_density</span><span class="p">(</span><span class="s1">&#39;example.nrrd&#39;</span><span class="p">,</span> <span class="n">experiments</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>

<span class="c1"># read it into memory</span>
<span class="n">pd_array</span><span class="p">,</span> <span class="n">pd_info</span> <span class="o">=</span> <span class="n">nrrd</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;example.nrrd&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="section" id="mouse-connectivity-cache">
<h2>Mouse Connectivity Cache<a class="headerlink" href="#mouse-connectivity-cache" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="allensdk.core.html#allensdk.core.mouse_connectivity_cache.MouseConnectivityCache" title="allensdk.core.mouse_connectivity_cache.MouseConnectivityCache"><code class="xref py py-class docutils literal"><span class="pre">MouseConnectivityCache</span></code></a> class saves all of the data you can download
via the <code class="xref py py-class docutils literal"><span class="pre">MouseConenctivityApi</span></code> in well known locations so that you
don&#8217;t have to think about file names and directories.  It also takes care of knowing if you&#8217;ve already downloaded some files
and reads them from disk instead of downloading them again.  The following example demonstrates how to download meta data for
all experiments with injections in the isocortex and download the projetion density volume for one of them:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">allensdk.core.mouse_connectivity_cache</span> <span class="k">import</span> <span class="n">MouseConnectivityCache</span>

<span class="c1"># tell the cache class what resolution (in microns) of data you want to download</span>
<span class="n">mcc</span> <span class="o">=</span> <span class="n">MouseConnectivityCache</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>

<span class="c1"># use the ontology class to get the id of the isocortex structure</span>
<span class="n">ontology</span> <span class="o">=</span> <span class="n">mcc</span><span class="o">.</span><span class="n">get_ontology</span><span class="p">(</span><span class="s1">&#39;ontology.csv&#39;</span><span class="p">)</span>
<span class="n">isocortex</span> <span class="o">=</span> <span class="n">ontology</span><span class="p">[</span><span class="s1">&#39;Isocortex&#39;</span><span class="p">]</span>

<span class="c1"># a list of dictionaries containing metadata for non-Cre experiments</span>
<span class="n">experiments</span> <span class="o">=</span> <span class="n">mcc</span><span class="o">.</span><span class="n">get_experiments</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;non_cre.json&#39;</span><span class="p">,</span>
                                  <span class="n">injection_structure_ids</span><span class="o">=</span><span class="n">isocortex</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

<span class="c1"># download the projection density volume for one of the experiments</span>
<span class="n">pd</span> <span class="o">=</span> <span class="n">mcc</span><span class="o">.</span><span class="n">get_projection_density</span><span class="p">(</span><span class="n">experiments</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

</pre></div>
</div>
</div>
<div class="section" id="file-formats">
<h2>File Formats<a class="headerlink" href="#file-formats" title="Permalink to this headline">¶</a></h2>
<p>This section provides a short description of the file formats used for data in the Allen Mouse Connectivity Atlas.</p>
<div class="section" id="nrrd-files">
<h3>NRRD Files<a class="headerlink" href="#nrrd-files" title="Permalink to this headline">¶</a></h3>
<p>All of the volumetric data in the connectivity atlas are stored as
<a class="reference external" href="http://teem.sourceforge.net/nrrd/">NRRD (Nearly Raw Raster Data)</a> files. A NRRD file
consists of a short ASCII header followed by a binary array of data values.</p>
<p>To read these in Python, we recommend the <a class="reference external" href="https://github.com/mhe/pynrrd">pynrrd package</a>.
Usage is straightforward:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nrrd</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;experiment_180435652/projection_density_25.nrrd&#39;</span>
<span class="n">data_array</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">nrrd</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Install Guide</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="data_resources.html">Data Resources</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="brain_observatory.html">Brain Observatory</a></li>
<li class="toctree-l2"><a class="reference internal" href="cell_types.html">Cell Types</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mouse Connectivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_space.html">Reference Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_api_client.html">API Access</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="glif_models.html">Generalized LIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="biophysical_models.html">Biophysical</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="allensdk.html">Source Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="allensdk.api.html">allensdk.api package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.brain_observatory.html">allensdk.brain_observatory package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.config.html">allensdk.config package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.core.html">allensdk.core package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.ephys.html">allensdk.ephys package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.model.html">allensdk.model package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.morphology.html">allensdk.morphology package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.test_utilities.html">allensdk.test_utilities package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/AllenInstitute/AllenSDK">Github Profile</a></li>
</ul>

<h3> Questions </h3>
<p class="questions">
  Send any questions using the <a href="http://alleninstitute.org/contact_us/index.html">Send Us a Message</a> link below, 
  or submit your question to <a href="http://stackoverflow.com/">StackOverflow</a> using with the 'allen-sdk' tag.
</p>

<p class="questions">
  If you encounter any problems using the AllenSDK, please create an issue on <a href="http://github.com/alleninstitute/allensdk/issues/">Github's issue tracker</a>.
</p>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>


    <div class="footer" role="contentinfo">
    </div>
<script type="text/javascript" src="http://www.brain-map.org/external_assets/javascripts/portalFooter.js"></script>


  </body>
</html>