<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Organization of a Brain Observatory NWB file &mdash; Allen SDK 0.13.1 documentation</title>
    
    <link rel="stylesheet" href="_static/aibs_sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.13.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Allen SDK 0.13.1 documentation" href="index.html" /> 
  </head>
  <body role="document">
<link href="http://www.brain-map.org/assets/stylesheets/portal.css" media="screen" rel="stylesheet" type="text/css" />
<script src="http://www.brain-map.org/assets/javascripts/portal.js" type="text/javascript"></script>
<script type="text/javascript">
    var _pSupressBrowserFlashWarning = true;
    var _pTabId = "pHome";
    var _pMoreProjectsId = "pMoreProjects";
    var _pImagePath = "http://www.brain-map.org/assets/images/";
    var _pSiteWarnings = function() {
        this.show_warning() = {};
    }
</script>
<script type="text/javascript">
    function initialize() {
        /*** do your stuff, then initialize the portal plugin ***/
        _pPortalOnLoad();
    }
</script>
<style>
  #header_content > a {
  display: inline-block;
  width: 250px;
  height: 75px;
  background-image:url("/AllenSDK/_static/external_assets/images/Brain_Atlas_Logotype_SDK.png") !important;
  background-size: 235px 37px;
  background-position: 0px 20px;
  background-repeat: no-repeat;
  }
</style>

<script type="text/javascript" src="http://www.brain-map.org/external_assets/javascripts/portalHeader.js"></script>
<link rel="stylesheet" type="text/css" href="/AllenSDK/_static/external_assets/stylesheets/common_layout.css" />


  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="organization-of-a-brain-observatory-nwb-file">
<h1>Organization of a Brain Observatory NWB file<a class="headerlink" href="#organization-of-a-brain-observatory-nwb-file" title="Permalink to this headline">¶</a></h1>
<p>The Allen Institute&#8217;s Brain Observatory data sets include data from 2-photon microscope recordings including image segmentation, motion correction and fluorescence traces.
It also includes information about the visual stimuli presented during the recording. This information is packaged in the <a class="reference external" href="http://www.nwb.org">NWB format</a>.
Here is a brief description how the data is stored in the NWB file.</p>
<div class="section" id="browsing-the-file">
<h2>Browsing the file<a class="headerlink" href="#browsing-the-file" title="Permalink to this headline">¶</a></h2>
<p>The NWB format is a self-documenting file format that is designed to store a wide range of neurophysiology data.
Structurally, NWB is nothing more than an HDF5 file that has data organized in a particular way.
For example, the format has a dedicated location for storing all data that is acquired during an experiment, and another place to store stimulus data that was presented.
Data is usually stored in a time series, and each time series has information to document the type of data that it stores.
Importantly, all HDF5 tools and libraries are able to read the NWB file.</p>
<p>When using NWB files, the most important tool to become familiar with is HDFView.
HDFView is an open-source tool that is published by the HDF Group.
It allows you to browse the contents of an HDF5 (and NWB) file in an intuitive way, and also to view some of the data stored within it.
HDFView can be downloaded at <a class="reference external" href="http://www.hdfgroup.org/products/java/hdfview/">www.hdfgroup.org</a>.
It is <em>highly</em> recommended that anyone using an NWB file download and install this tool.</p>
</div>
<div class="section" id="nwb-file-organization">
<h2>NWB file organization<a class="headerlink" href="#nwb-file-organization" title="Permalink to this headline">¶</a></h2>
<p>Each NWB file is organized into six sections. These sections store acquired data (&#8216;acquisition&#8217;), stimulus data (&#8216;stimulus&#8217;), general metadata about the experiment (&#8216;general&#8217;), experiment organization (&#8216;epochs&#8217;), processed data (&#8216;processing&#8217;) and a free-form area for storing analysis data (&#8216;analysis&#8217;).</p>
<div class="figure" id="id1">
<img alt="_images/fig-1.png" src="_images/fig-1.png" />
<p class="caption"><span class="caption-text"><strong>Figure 1. An NWB file, viewed in HDFView</strong></span></p>
</div>
<p>At the left of HDFView shows the organization of data in an NWB file.
It is most useful to imagine an HDF5 file as a container that stores many files and folders within it.
Because of this structure, you can browse an HDF5 file, and an NWB file, in the same way that you browse the files and folders on your computer.
Folders can be opened by double-clicking on the folder icon.
The contents of a &#8216;file&#8217; within HDF5, which called a dataset, can be seen by double-clicking it.
An NWB file has six top-level folders and five top-level datasets.
In Figure 1, the contents of the &#8216;session_description&#8217; dataset is displayed.
An NWB file is designed to store data from a single experimental session in a single animal.
The session_description dataset provides a quick summary of the information available in the file.
The NWB specification, describing the format and how data is stored, can be downloaded <a class="reference external" href="http://github.com/NeurodataWithoutBorders/specification/blob/master/version_1.0.3/nwb_file_format_specification_v1.0.3.pdf">here</a>.</p>
</div>
<div class="section" id="stimulus-data">
<h2>Stimulus data<a class="headerlink" href="#stimulus-data" title="Permalink to this headline">¶</a></h2>
<p>Within an NWB file, stimulus data is organized into &#8216;templates&#8217;, which are stimulus descriptions that can be used one or more times, and &#8216;presentation&#8217;, which stores the time-series data about what was presented and when.</p>
<div class="figure" id="id2">
<img alt="_images/fig-2.png" src="_images/fig-2.png" />
<p class="caption"><span class="caption-text"><strong>Figure 2. Stimuli presented during the experiment</strong></span></p>
</div>
<p>In this experiment shown in Figure 2, there were four stimuli – one locally sparse noise, two movies and one neutral stimulus for observing spontaneous activity.
When browsing the file, note the panel at the bottom.
Clicking on a folder or dataset will cause information about that object to be displayed there.
This information can include the type of data stored, the unit that stored in, as well as comments and/or other metadata.</p>
</div>
<div class="section" id="processing">
<h2>Processing<a class="headerlink" href="#processing" title="Permalink to this headline">¶</a></h2>
<p>In the NWB file, the processing folder is designed to store the contents the different levels of intermediate processing of data that are necessary to convert raw data into something that can be used for scientific analysis.
In the Allen Institute&#8217;s NWB file, these levels of processing include motion correction of the acquired 2-photon move frames, image segmentation into regions of interest, the fluorescence signal for each of these regions, and the dF/F signal that is useful for correlating cell activity with presented stimuli.</p>
<div class="figure" id="id3">
<img alt="_images/fig-3.png" src="_images/fig-3.png" />
<p class="caption"><span class="caption-text"><strong>Figure 3. Location of dF/F data</strong></span></p>
</div>
<p>HDFView provides a very efficient way to browse the contents of an NWB file.</p>
</div>
<div class="section" id="organization-of-data">
<h2>Organization of data<a class="headerlink" href="#organization-of-data" title="Permalink to this headline">¶</a></h2>
<p>This data release was based on three different sets of stimuli, name &#8216;A&#8217;, &#8216;B&#8217; and &#8216;C&#8217;.</p>
<p>Stimulus A included:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Drifting grating (30 minutes over 3 intervals)</li>
<li>Natural movie (20 minutes over 2 intervals)</li>
<li>Natural movie (5 minutes in 1 interval)</li>
<li>Spontaneous activity (5 minutes in 1 interval)</li>
</ol>
</div></blockquote>
<p>This was presented as: (1) (2) (3) (1) (2) (4) (1) (2)</p>
<p>Stimulus B included:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Static gratings (25 minutes over 3 intervals)</li>
<li>Natural images (25 minutes over 3 intervals)</li>
<li>Natural movie (5 minutes in 1 interval)</li>
<li>Spontaneous activity (5 minutes in 1 interval)</li>
</ol>
</div></blockquote>
<p>This was presented as: (1) (2) (4) (2) (1) (3) (1) (2)</p>
<p>Stimulus C included:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Locally sparse noise (37 minutes over 3 intervals)</li>
<li>Natural movie (5 minutes over 1 interval)</li>
<li>Natural movie (5 minutes over 1 interval)</li>
<li>Spontaneous activity (10 minutes over 2 intervals)</li>
</ol>
</div></blockquote>
<p>This was presented as: (1) (4) (2) (1) (3) (4) (1)</p>
<p>Below is a brief description and location for several types of data in the NWB file.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="16%" />
<col width="42%" />
<col width="34%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Category</th>
<th class="head">Data</th>
<th class="head">Location</th>
<th class="head">SDK function(s)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td rowspan="4">Metadata</td>
<td>Cre line</td>
<td>/general/subject/genotype</td>
<td rowspan="4"><ul class="first last simple">
<li>get_metadata</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>Imaging depth</td>
<td>/general/optophysiology/imaging_plane_1/imaging_depth</td>
</tr>
<tr class="row-even"><td>Target structure</td>
<td>/general/targeted_structure</td>
</tr>
<tr class="row-odd"><td>Stimulus session</td>
<td>/general/session_type</td>
</tr>
<tr class="row-even"><td rowspan="4">Stimulus</td>
<td>Locally sparse noise</td>
<td>/stimulus/presentation/locally_sparse_noise_stimulus</td>
<td><ul class="first last simple">
<li>get_stimulus_table</li>
<li>get_locally_sparse_noise_stimulus_template</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>Natural movie (1)</td>
<td>/stimulus/presentation/natural_movie_one_stimulus</td>
<td rowspan="2"><ul class="first last simple">
<li>get_stimulus_table</li>
</ul>
</td>
</tr>
<tr class="row-even"><td>Natural movie (2)</td>
<td>/stimulus/presentation/natural_movie_two_stimulus</td>
</tr>
<tr class="row-odd"><td>Gray-screen</td>
<td>/stimulus/presentation/spontaneous_stimulus</td>
<td><ul class="first last simple">
<li>get_stimulus_table</li>
</ul>
</td>
</tr>
<tr class="row-even"><td rowspan="4">Processed
data</td>
<td>Motion correction</td>
<td>/processing/visual_coding_pipeline/MotionCorrection</td>
<td><ul class="first last simple">
<li>get_motion_correction</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>Image segmentation</td>
<td>/processing/visual_coding_pipeline/ImageSegmentation</td>
<td><ul class="first last simple">
<li>get_roi_ids</li>
<li>get_cell_specimen_ids</li>
<li>get_roi_mask</li>
</ul>
</td>
</tr>
<tr class="row-even"><td>Fluorescence</td>
<td>/processing/visual_coding_pipeline/Fluorescence</td>
<td><ul class="first last simple">
<li>get_fluorescence_traces</li>
<li>get_neuropil_traces</li>
<li>get_corrected_fluorescence_traces</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>dF/F</td>
<td>/processing/visual_coding_pipeline/DfOverF</td>
<td><ul class="first last simple">
<li>get_dff_traces</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install Guide</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_resources.html">Data Resources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="brain_observatory.html">Brain Observatory</a></li>
<li class="toctree-l2"><a class="reference internal" href="cell_types.html">Cell Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="connectivity.html">Mouse Connectivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_space.html">Reference Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_api_client.html">API Access</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="glif_models.html">Generalized LIF</a></li>
<li class="toctree-l2"><a class="reference internal" href="biophysical_models.html">Biophysical</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="allensdk.html">Source Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="allensdk.api.html">allensdk.api package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.brain_observatory.html">allensdk.brain_observatory package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.config.html">allensdk.config package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.core.html">allensdk.core package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.ephys.html">allensdk.ephys package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.model.html">allensdk.model package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.morphology.html">allensdk.morphology package</a></li>
<li class="toctree-l2"><a class="reference internal" href="allensdk.test_utilities.html">allensdk.test_utilities package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/AllenInstitute/AllenSDK">Github Profile</a></li>
</ul>

<h3> Questions </h3>
<p class="questions">
  Send any questions using the <a href="http://alleninstitute.org/contact_us/index.html">Send Us a Message</a> link below, 
  or submit your question to <a href="http://stackoverflow.com/">StackOverflow</a> using with the 'allensdk' tag.
</p>

<p class="questions">
  If you encounter any problems using the AllenSDK, please create an issue on <a href="http://github.com/alleninstitute/allensdk/issues/">Github's issue tracker</a>.
</p>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>


    <div class="footer" role="contentinfo">
    </div>
<script type="text/javascript" src="http://www.brain-map.org/external_assets/javascripts/portalFooter.js"></script>


  </body>
</html>